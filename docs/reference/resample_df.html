<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>resampling — resample_df â€¢ PKPDmisc</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">PKPDmisc</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/multiplot.html">Multiplots</a>
    </li>
    <li>
      <a href="../articles/noncompartmental-analysis.html">Noncompartmental Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dpastoor/PKPDmisc">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>resampling</h1>
    </div>

    
    <p>resampling</p>
    

    <pre class="usage"><span class='fu'>resample_df</span>(<span class='no'>df</span>, <span class='no'>key_cols</span>, <span class='kw'>strat_cols</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>key_col_name</span> <span class='kw'>=</span> <span class='st'>"KEY"</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>data frame</p></td>
    </tr>
    <tr>
      <th>key_cols</th>
      <td><p>key columns to resample on</p></td>
    </tr>
    <tr>
      <th>strat_cols</th>
      <td><p>columns to maintain proportion for stratification</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of unique sampled keys, defaults to match dataset</p></td>
    </tr>
    <tr>
      <th>key_col_name</th>
      <td><p>name of outputted key column. Default to "KEY"</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>whether to stratify with replacement</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is valuable when generating a large simulated population
where you goal is to create resampled sub-populations in addition to being able to
maintain certain stratifications of factors like covariate distributions</p>
<p>A new keyed column will be created (defaults to name 'KEY') that contains the uniquely
created new samples. This allows one to easily compare against the key'd columns. Eg,
if you would like to see how many times a particular individual was resampled you can 
check the original ID column against the number of key's associated with that ID number.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>PKPDmisc</span>)
<span class='fu'>library</span>(<span class='no'>dplyr</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># simple example resampling by ID maintaining Gender distribution, with 10 individuals</span>
<span class='fu'>resample_df</span>(<span class='no'>sd_oral_richpk</span>, <span class='kw'>key_cols</span> <span class='kw'>=</span> <span class='st'>"ID"</span>, <span class='kw'>strat_cols</span> <span class='kw'>=</span> <span class='st'>"Gender"</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10</span>)</div><div class='output co'>#&gt; # A tibble: 120 x 10
#&gt;      KEY    ID  Time   Amt      Conc      Age   Weight Gender   Race  Dose
#&gt;    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fctr&gt; &lt;fctr&gt; &lt;int&gt;
#&gt;  1     1    26  0.00  5000   0.00000 41.26571 56.59549 Female  Black  5000
#&gt;  2     1    26  0.25     0  27.73210 41.26571 56.59549 Female  Black  5000
#&gt;  3     1    26  0.50     0  53.33475 41.26571 56.59549 Female  Black  5000
#&gt;  4     1    26  1.00     0  82.48312 41.26571 56.59549 Female  Black  5000
#&gt;  5     1    26  2.00     0 101.91661 41.26571 56.59549 Female  Black  5000
#&gt;  6     1    26  3.00     0  81.67875 41.26571 56.59549 Female  Black  5000
#&gt;  7     1    26  4.00     0  89.99290 41.26571 56.59549 Female  Black  5000
#&gt;  8     1    26  6.00     0  73.01971 41.26571 56.59549 Female  Black  5000
#&gt;  9     1    26  8.00     0  60.02791 41.26571 56.59549 Female  Black  5000
#&gt; 10     1    26 12.00     0  48.67562 41.26571 56.59549 Female  Black  5000
#&gt; # ... with 110 more rows</div><div class='input'>
<span class='co'># for a more complex example lets resample "simulated" data with multiple replicates</span>
<span class='no'>subset_data</span> <span class='kw'>&lt;-</span> <span class='no'>sd_oral_richpk</span> <span class='kw'>%&gt;%</span>
   <span class='fu'><a href='http://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>ID</span> <span class='kw'>&lt;</span> <span class='fl'>20</span>)

<span class='co'># make 'simulated' data with 5 replicates and combine to single dataframe</span>
<span class='no'>rep_dat</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>function</span>(<span class='no'>x</span>) {
<span class='no'>subset_data</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>REP</span> <span class='kw'>=</span> <span class='no'>x</span>)
  }) <span class='kw'>%&gt;%</span> <span class='fu'><a href='http://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span>()

<span class='co'># now when we resample we also want to maintain the ID+REP relationship as resampling</span>
<span class='co'># just the ID would give all rows associated for an ID with all reps, rather than </span>
<span class='co'># a single "unit" of ID/REP</span>
<span class='fu'>resample_df</span>(<span class='no'>rep_dat</span>, <span class='kw'>key_cols</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"ID"</span>, <span class='st'>"REP"</span>))</div><div class='output co'>#&gt; # A tibble: 1,140 x 11
#&gt;      KEY    ID  Time   Amt     Conc      Age   Weight Gender      Race  Dose
#&gt;    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fctr&gt;    &lt;fctr&gt; &lt;int&gt;
#&gt;  1     1     4  0.00  5000  0.00000 46.87347 62.47354 Female Caucasian  5000
#&gt;  2     1     4  0.25     0 29.30308 46.87347 62.47354 Female Caucasian  5000
#&gt;  3     1     4  0.50     0 50.49399 46.87347 62.47354 Female Caucasian  5000
#&gt;  4     1     4  1.00     0 66.44664 46.87347 62.47354 Female Caucasian  5000
#&gt;  5     1     4  2.00     0 88.99138 46.87347 62.47354 Female Caucasian  5000
#&gt;  6     1     4  3.00     0 75.05583 46.87347 62.47354 Female Caucasian  5000
#&gt;  7     1     4  4.00     0 96.68389 46.87347 62.47354 Female Caucasian  5000
#&gt;  8     1     4  6.00     0 56.19676 46.87347 62.47354 Female Caucasian  5000
#&gt;  9     1     4  8.00     0 66.60407 46.87347 62.47354 Female Caucasian  5000
#&gt; 10     1     4 12.00     0 38.96617 46.87347 62.47354 Female Caucasian  5000
#&gt; # ... with 1,130 more rows, and 1 more variables: REP &lt;int&gt;</div><div class='input'>
<span class='co'># check to see that stratification is maintained</span>
<span class='no'>rep_dat</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>Gender</span>) <span class='kw'>%&gt;%</span> <span class='no'>tally</span></div><div class='output co'>#&gt; # A tibble: 2 x 2
#&gt;   Gender     n
#&gt;   &lt;fctr&gt; &lt;int&gt;
#&gt; 1 Female   300
#&gt; 2   Male   840</div><div class='input'><span class='fu'>resample_df</span>(<span class='no'>rep_dat</span>, <span class='kw'>key_cols</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"ID"</span>, <span class='st'>"REP"</span>), <span class='kw'>strat_cols</span><span class='kw'>=</span><span class='st'>"Gender"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>Gender</span>) <span class='kw'>%&gt;%</span> <span class='no'>tally</span></div><div class='output co'>#&gt; # A tibble: 2 x 2
#&gt;   Gender     n
#&gt;   &lt;fctr&gt; &lt;int&gt;
#&gt; 1 Female   300
#&gt; 2   Male   840</div><div class='input'>
<span class='no'>rep_dat</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>Gender</span>, <span class='no'>Race</span>) <span class='kw'>%&gt;%</span> <span class='no'>tally</span></div><div class='output co'>#&gt; # A tibble: 8 x 3
#&gt; # Groups:   Gender [?]
#&gt;   Gender      Race     n
#&gt;   &lt;fctr&gt;    &lt;fctr&gt; &lt;int&gt;
#&gt; 1 Female Caucasian   180
#&gt; 2 Female  Hispanic    60
#&gt; 3 Female     Other    60
#&gt; 4   Male     Asian   120
#&gt; 5   Male     Black   180
#&gt; 6   Male Caucasian    60
#&gt; 7   Male  Hispanic   180
#&gt; 8   Male     Other   300</div><div class='input'>
<span class='fu'>resample_df</span>(<span class='no'>rep_dat</span>, <span class='kw'>key_cols</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"ID"</span>, <span class='st'>"REP"</span>), <span class='kw'>strat_cols</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"Gender"</span>, <span class='st'>"Race"</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>Gender</span>, <span class='no'>Race</span>) <span class='kw'>%&gt;%</span> <span class='no'>tally</span></div><div class='output co'>#&gt; # A tibble: 8 x 3
#&gt; # Groups:   Gender [?]
#&gt;   Gender      Race     n
#&gt;   &lt;fctr&gt;    &lt;fctr&gt; &lt;int&gt;
#&gt; 1 Female Caucasian   180
#&gt; 2 Female  Hispanic    60
#&gt; 3 Female     Other    60
#&gt; 4   Male     Asian   120
#&gt; 5   Male     Black   180
#&gt; 6   Male Caucasian    60
#&gt; 7   Male  Hispanic   180
#&gt; 8   Male     Other   300</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Devin Pastoor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
